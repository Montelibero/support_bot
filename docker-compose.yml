services:
  redis:
    image: redis:alpine
    restart: always
    # Enable persistence for Redis
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data

  bot:
    build: .
    restart: always
    # Mount data directory to persist support.db
    # Mount logs directory to persist logs
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    environment:
      # Connection to Redis service
      - REDIS_URL=redis://redis:6379/1

      # Single Bot Configuration
      - SINGLE_BOT_TOKEN=your_bot_token_here
      - ADMIN_ID=123456789

      # Optional Settings
      - SINGLE_START_MESSAGE=Здравствуйте! Чем могу помочь?
      - SINGLE_SECURITY_POLICY=default
      - SINGLE_MASTER_CHAT=0
      - SINGLE_USE_AUTO_REPLY=false
      - SINGLE_AUTO_REPLY=Message automatically forwarded to support. Please wait for a response.
      - SENTRY_DSN=
    depends_on:
      - redis
    command: uv run single_bot.py

volumes:
  redis_data:
